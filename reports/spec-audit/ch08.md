# Chapter 8 Audit (Frontend stack/components/viewer/panels/state/API client)

Scope: `TECHNICAL_SPECIFICATION.md:1123-1274`

## High-confidence mismatches (old â†’ new)

1) **OpenSeadragon version is outdated**
- **Spec** `TECHNICAL_SPECIFICATION.md:1131`
- **Old:** `| OpenSeadragon | 4.1 | Tile-based whole-slide image viewer |`
- **New:** `| OpenSeadragon | 5.0.1 | Tile-based whole-slide image viewer |`

2) **Home page size + header mode/toggle details are stale**
- **Spec** `TECHNICAL_SPECIFICATION.md:1140,1143,1145`
- **Old:** `+-- HomePage (page.tsx, 2142 lines)`
- **New:** `+-- HomePage (page.tsx, ~2472 lines)`
- **Old:** `|   +-- ViewModeToggle (oncologist/pathologist)`
- **New:** `|   +-- ViewModeToggle (oncologist/pathologist/batch)`
- **Old:** `|   +-- Dark Mode Toggle`
- **New:** `|   +-- Settings menu (opens SettingsModal theme selector)`

3) **Left/right panel hierarchy does not match current render tree**
- **Spec** `TECHNICAL_SPECIFICATION.md:1149,1167-1172`
- **Old:** `|   +-- QuickStatsPanel`
- **New:** `|   +-- CaseNotesPanel`
- **Old:**
  - `|   +-- BatchAnalysisPanel (43,366 bytes)`
  - `|   +-- AIAssistantPanel (38,056 bytes)`
  - `|   +-- PatchClassifierPanel (16,135 bytes)`
  - `|   +-- UncertaintyPanel`
- **New:**
  - `|   +-- (oncologist mode) PredictionPanel / MultiModelPredictionPanel / EvidencePanel / SemanticSearchPanel / SimilarCasesPanel / OutlierDetectorPanel / ReportPanel`
  - `|   +-- (pathologist mode) PathologistView`
  - `+-- Batch mode (outside sidebars): BatchAnalysisPanel (~45,905 bytes)`

4) **Slides/Projects page hierarchy names are inaccurate**
- **Spec** `TECHNICAL_SPECIFICATION.md:1182-1193`
- **Old:** `+-- SlideManager`
- **New:** `+-- Page-level state (no SlideManager wrapper)`
- **Old:** `+-- GridView / TableView (with thumbnails)`
- **New:** `+-- SlideGrid / SlideTable (with thumbnails)`
- **Old:** `+-- ProjectManager`
- **New:** `+-- Page-level project CRUD/status (no ProjectManager wrapper)`
- **Old:**
  - `+-- ModelAssignment`
  - `+-- SlideAssignment`
- **New:**
  - `+-- ProjectFormModal (create/edit)`
  - `+-- SlideUploadModal`
  - `+-- DeleteConfirmModal`

5) **WSIViewer file size in title is stale**
- **Spec** `TECHNICAL_SPECIFICATION.md:1196`
- **Old:** `## 8.3 WSI Viewer (61,161 bytes)`
- **New:** `## 8.3 WSI Viewer (74,056 bytes)`

6) **Spatial patch-selection bullet overstates active UX**
- **Spec** `TECHNICAL_SPECIFICATION.md:1207`
- **Old:** `- **Spatial Patch Selection:** Click-to-select mode for few-shot classifier. Clicking on the viewer identifies the nearest patch and adds it to the active class`
- **New:** `- **Spatial Patch Selection (viewer support only):** WSIViewer contains nearest-patch click selection logic, but the few-shot classifier panel is currently disabled on the home page.`

7) **Dark mode section overstates implementation status**
- **Spec** `TECHNICAL_SPECIFICATION.md:1240-1245`
- **Old:**
  - `Full dark mode support via Tailwind CSS \`dark:\` variant:`
  - `- Toggle in the header persisted to localStorage`
  - `- All components styled with dark variants (slate-800, slate-700, etc.)`
  - `- OpenSeadragon navigator styled with dark background`
  - `- Charts and visualizations adapt to dark theme`
- **New:**
  - `Theme preference is available in SettingsModal and persisted to localStorage (key: \`atlas-theme\`).`
  - `A \`.dark\` variable theme exists in global CSS, but component-level \`dark:\` Tailwind variants are not broadly implemented yet.`

8) **API client size + SSE claim are outdated**
- **Spec** `TECHNICAL_SPECIFICATION.md:1267,1273`
- **Old:** `## 8.7 API Client (2,625 lines)`
- **New:** `## 8.7 API Client (3,054 lines)`
- **Old:** `- **SSE Streaming:** AsyncGenerator for agent and chat endpoints`
- **New:** `- **SSE Streaming:** \`frontend/src/lib/api.ts\` does not implement AsyncGenerator/SSE helpers for agent/chat; SSE parsing currently lives in \`AIAssistantPanel.tsx\`.`
